---
import logoStar from '../assets/logo-star.svg'
import svgPinkStar from '../assets/pink-star.svg'
import { author, buy } from '../sample'
import ThemeSwitcher from './ThemeSwitcher.astro'

const links = [
    { name: 'About', path: '/', target: '_self' },
    { name: 'Blog', path: '/blog/', target: '_self' },
    { name: 'Hire Me', path: buy.link, target: '_blank' },
]

const { pathname } = Astro.url
---

<header class="relative border-b-3 themed-border p-7 overflow-hidden" style="background-color: var(--main-bg);">
    <img src={svgPinkStar.src} alt="svg" width="80" class="absolute -right-9 -top-4 themed-svg" />
    <img src={svgPinkStar.src} alt="svg" width="80" class="absolute -left-8 -bottom-5 hidden md:block themed-svg" />

    <div class="flex items-center gap-3 max-w-[310px] md:max-w-xl m-auto relative z-10">
        <div class="flex flex-1 border-3 themed-border themed-card relative">
            <!-- top boxes -->
            <div class="size-2 themed-card border-2 themed-border absolute -top-2 -right-2"></div>
            <div class="size-2 themed-card border-2 themed-border absolute -top-2 -left-2"></div>

            <!-- bottom boxes -->
            <div class="size-2 themed-card border-2 themed-border absolute -bottom-2 -left-2"></div>
            <div class="size-2 themed-card border-2 themed-border absolute -bottom-2 -right-2"></div>
        
            <nav class="flex w-full items-center p-2 md:p-0">
                <div class="flex-1 font-bold">
                    <a href="/" class="flex items-center gap-2 pl-3" style="color: var(--text-color);">
                        <img src={logoStar.src} alt="logo" width="26" class="themed-svg" /> {author.nickname}
                    </a>
                </div>
                <a href="#" class="flex md:hidden" id="menu-open" style="color: var(--text-color);">
                    <i class="ri-menu-2-line text-2xl"></i>
                </a>
                <ul class="hidden md:flex">
                    {links.map(item => ( 
                        <li class="border-l-2 themed-border p-3 py-4">
                            <a href={item.path} target={item.target} class="whitespace-nowrap relative flex items-center before:absolute before:left-0 before:bottom-1 before:h-[8px] before:w-0 before:bg-[var(--yellow)] before:transition-all before:duration-300 hover:before:w-full" style="color: var(--text-color);">
                                <span class="relative z-5">{item.name} {pathname == item.path ? '//' : ''}</span>
                            </a>
                        </li>
                    ))}
                </ul>
            </nav>
        </div>
        
        <!-- Theme Switcher -->
        <div class="hidden md:block">
            <ThemeSwitcher />
        </div>
    </div>
  </header>

  <div class="block md:hidden fixed left-0 top-0 h-full w-full z-20 p-3 transition-all duration-300 -translate-x-[100%]" id="menu-content" style="background-color: var(--card-bg);">
    <div class="flex p-6">
        <h3 class="flex-1 font-bold uppercase" style="color: var(--text-color);">Menu</h3>
        <a href="#" id="menu-close" style="color: var(--text-color);">               
           <i class="ri-close-line text-3xl"></i>
        </a>
    </div>
    <ul class="flex flex-col justify-center items-center gap-4 md:hidden">
        {links.map(item => ( 
            <li class="py-3">
                <a href={item.path} target={item.target} class="p-3 whitespace-nowrap text-2xl font-bold" style="color: var(--text-color);">
                    {item.name} {pathname == item.path ? '//' : ''}
                </a>
            </li>
        ))}
    </ul>
    <div class="flex justify-center mt-10">
        <ThemeSwitcher />
    </div>
  </div>


<script>
document.addEventListener('DOMContentLoaded', function () {
    const menuContent = document.querySelector('#menu-content') 
    const menuOpen = document.querySelector('#menu-open') 
    const menuClose = document.querySelector('#menu-close') 


    menuOpen?.addEventListener('click', (e) => {
        e.preventDefault()
        menuContent?.classList.remove('-translate-x-[100%]')
    })

    menuClose?.addEventListener('click', (e) => {
        e.preventDefault()
        menuContent?.classList.add('-translate-x-[100%]')
    })


    menuContent?.querySelectorAll('li a').forEach(item => {
        item.addEventListener('click', (e) => {
            menuContent?.classList.add('-translate-x-[100%]')
        })
    })
})
</script>